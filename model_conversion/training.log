============================================================
Fine-tuning ViT-Large on Food-101
Target Accuracy: 95%+
============================================================

Using device: mps

Step 1: Loading Food-101 dataset...
Generating train split:   0%|          | 0/75750 [00:00<?, ? examples/s]Generating train split:   0%|          | 100/75750 [00:00<01:22, 913.40 examples/s]Generating train split:   4%|▍         | 2900/75750 [00:00<00:04, 15278.07 examples/s]Generating train split:   7%|▋         | 5600/75750 [00:00<00:03, 20238.38 examples/s]Generating train split:  10%|█         | 7800/75750 [00:00<00:04, 13741.17 examples/s]Generating train split:  13%|█▎        | 9569/75750 [00:00<00:05, 12053.85 examples/s]Generating train split:  15%|█▌        | 11369/75750 [00:01<00:11, 5670.34 examples/s]Generating train split:  17%|█▋        | 12569/75750 [00:01<00:10, 5833.02 examples/s]Generating train split:  18%|█▊        | 13469/75750 [00:02<00:18, 3370.33 examples/s]Generating train split:  19%|█▊        | 14169/75750 [00:02<00:22, 2692.44 examples/s]Generating train split:  19%|█▉        | 14769/75750 [00:03<00:22, 2749.78 examples/s]Generating train split:  20%|██        | 15369/75750 [00:03<00:19, 3043.26 examples/s]Generating train split:  21%|██        | 15869/75750 [00:03<00:19, 3138.84 examples/s]Generating train split:  22%|██▏       | 16569/75750 [00:04<00:32, 1841.23 examples/s]Generating train split:  23%|██▎       | 17369/75750 [00:04<00:24, 2355.22 examples/s]Generating train split:  24%|██▍       | 18369/75750 [00:04<00:18, 3124.17 examples/s]Generating train split:  25%|██▌       | 19038/75750 [00:04<00:16, 3537.54 examples/s]Generating train split:  26%|██▌       | 19838/75750 [00:04<00:14, 3833.64 examples/s]Generating train split:  27%|██▋       | 20538/75750 [00:05<00:24, 2210.36 examples/s]Generating train split:  28%|██▊       | 21238/75750 [00:05<00:20, 2625.49 examples/s]Generating train split:  29%|██▊       | 21738/75750 [00:05<00:19, 2705.31 examples/s]Generating train split:  29%|██▉       | 22238/75750 [00:05<00:18, 2854.38 examples/s]Generating train split:  30%|███       | 22938/75750 [00:05<00:18, 2879.49 examples/s]Generating train split:  31%|███       | 23638/75750 [00:06<00:16, 3115.18 examples/s]Generating train split:  32%|███▏      | 24238/75750 [00:06<00:16, 3194.73 examples/s]Generating train split:  33%|███▎      | 24838/75750 [00:06<00:14, 3605.37 examples/s]Generating train split:  34%|███▍      | 25638/75750 [00:06<00:13, 3762.03 examples/s]Generating train split:  35%|███▍      | 26138/75750 [00:06<00:13, 3571.76 examples/s]Generating train split:  35%|███▌      | 26638/75750 [00:06<00:13, 3773.10 examples/s]Generating train split:  36%|███▌      | 27238/75750 [00:07<00:12, 3797.36 examples/s]Generating train split:  37%|███▋      | 27838/75750 [00:07<00:13, 3503.28 examples/s]Generating train split:  38%|███▊      | 28407/75750 [00:07<00:13, 3568.19 examples/s]Generating train split:  38%|███▊      | 28807/75750 [00:07<00:14, 3170.64 examples/s]Generating train split:  39%|███▉      | 29607/75750 [00:07<00:16, 2736.14 examples/s]Generating train split:  41%|████      | 30707/75750 [00:08<00:11, 4029.15 examples/s]Generating train split:  42%|████▏     | 31807/75750 [00:08<00:08, 5257.73 examples/s]Generating train split:  44%|████▎     | 33007/75750 [00:08<00:06, 6629.36 examples/s]Generating train split:  45%|████▌     | 34207/75750 [00:08<00:05, 7559.23 examples/s]Generating train split:  47%|████▋     | 35407/75750 [00:08<00:05, 7429.34 examples/s]Generating train split:  48%|████▊     | 36307/75750 [00:08<00:05, 7673.59 examples/s]Generating train split:  49%|████▉     | 37407/75750 [00:08<00:04, 7883.58 examples/s]Generating train split:  51%|█████     | 38376/75750 [00:08<00:05, 6930.24 examples/s]Generating train split:  52%|█████▏    | 39376/75750 [00:09<00:06, 6015.53 examples/s]Generating train split:  53%|█████▎    | 40076/75750 [00:09<00:05, 6088.73 examples/s]Generating train split:  54%|█████▍    | 40976/75750 [00:09<00:05, 6127.51 examples/s]Generating train split:  55%|█████▌    | 41776/75750 [00:09<00:05, 6274.73 examples/s]Generating train split:  56%|█████▌    | 42476/75750 [00:09<00:05, 6033.44 examples/s]Generating train split:  58%|█████▊    | 43776/75750 [00:09<00:04, 7345.11 examples/s]Generating train split:  60%|█████▉    | 45276/75750 [00:09<00:03, 7834.46 examples/s]Generating train split:  61%|██████▏   | 46576/75750 [00:10<00:03, 8830.86 examples/s]Generating train split:  63%|██████▎   | 47845/75750 [00:10<00:03, 7964.79 examples/s]Generating train split:  64%|██████▍   | 48845/75750 [00:10<00:03, 8395.32 examples/s]Generating train split:  66%|██████▌   | 49945/75750 [00:10<00:03, 8277.94 examples/s]Generating train split:  68%|██████▊   | 51845/75750 [00:10<00:02, 8957.53 examples/s]Generating train split:  70%|██████▉   | 52845/75750 [00:10<00:02, 7870.79 examples/s]Generating train split:  71%|███████▏  | 54145/75750 [00:11<00:02, 8023.44 examples/s]Generating train split:  73%|███████▎  | 55345/75750 [00:11<00:02, 7909.22 examples/s]Generating train split:  74%|███████▍  | 56145/75750 [00:11<00:02, 6839.68 examples/s]Generating train split:  75%|███████▌  | 56914/75750 [00:11<00:02, 6973.72 examples/s]Generating train split:  77%|███████▋  | 58014/75750 [00:11<00:02, 5985.06 examples/s]Generating train split:  78%|███████▊  | 58814/75750 [00:11<00:02, 6064.76 examples/s]Generating train split:  79%|███████▉  | 59814/75750 [00:11<00:02, 6755.18 examples/s]Generating train split:  80%|████████  | 60714/75750 [00:12<00:02, 7128.28 examples/s]Generating train split:  81%|████████▏ | 61614/75750 [00:12<00:01, 7146.70 examples/s]Generating train split:  82%|████████▏ | 62414/75750 [00:12<00:01, 7101.82 examples/s]Generating train split:  84%|████████▎ | 63314/75750 [00:12<00:01, 7233.51 examples/s]Generating train split:  85%|████████▌ | 64414/75750 [00:12<00:01, 7978.32 examples/s]Generating train split:  87%|████████▋ | 65914/75750 [00:12<00:01, 8154.19 examples/s]Generating train split:  88%|████████▊ | 66882/75750 [00:12<00:01, 7123.65 examples/s]Generating train split:  89%|████████▉ | 67682/75750 [00:13<00:01, 5977.39 examples/s]Generating train split:  91%|█████████ | 68682/75750 [00:13<00:01, 5981.47 examples/s]Generating train split:  92%|█████████▏| 69482/75750 [00:13<00:01, 5960.57 examples/s]Generating train split:  93%|█████████▎| 70282/75750 [00:13<00:01, 4889.37 examples/s]Generating train split:  94%|█████████▎| 70982/75750 [00:13<00:00, 5083.66 examples/s]Generating train split:  95%|█████████▌| 72282/75750 [00:13<00:00, 6425.60 examples/s]Generating train split:  97%|█████████▋| 73582/75750 [00:14<00:00, 7518.40 examples/s]Generating train split:  99%|█████████▊| 74782/75750 [00:14<00:00, 8449.82 examples/s]Generating train split: 100%|██████████| 75750/75750 [00:14<00:00, 7951.00 examples/s]Generating train split: 100%|██████████| 75750/75750 [00:14<00:00, 5310.83 examples/s]
Generating validation split:   0%|          | 0/25250 [00:00<?, ? examples/s]Generating validation split:   1%|          | 300/25250 [00:00<00:11, 2086.11 examples/s]Generating validation split:   3%|▎         | 700/25250 [00:00<00:10, 2423.82 examples/s]Generating validation split:   8%|▊         | 1900/25250 [00:00<00:04, 5786.15 examples/s]Generating validation split:  13%|█▎        | 3200/25250 [00:00<00:02, 7884.79 examples/s]Generating validation split:  18%|█▊        | 4600/25250 [00:00<00:02, 9368.13 examples/s]Generating validation split:  24%|██▍       | 6100/25250 [00:00<00:01, 10662.49 examples/s]Generating validation split:  30%|██▉       | 7500/25250 [00:01<00:02, 7838.73 examples/s] Generating validation split:  34%|███▎      | 8517/25250 [00:01<00:03, 4316.01 examples/s]Generating validation split:  37%|███▋      | 9317/25250 [00:02<00:05, 2901.09 examples/s]Generating validation split:  40%|███▉      | 10017/25250 [00:02<00:06, 2345.57 examples/s]Generating validation split:  42%|████▏     | 10517/25250 [00:02<00:06, 2408.58 examples/s]Generating validation split:  44%|████▎     | 11017/25250 [00:02<00:05, 2406.39 examples/s]Generating validation split:  46%|████▌     | 11517/25250 [00:03<00:05, 2435.58 examples/s]Generating validation split:  47%|████▋     | 11917/25250 [00:03<00:05, 2526.43 examples/s]Generating validation split:  49%|████▉     | 12417/25250 [00:03<00:05, 2333.44 examples/s]Generating validation split:  52%|█████▏    | 13117/25250 [00:03<00:04, 2927.00 examples/s]Generating validation split:  54%|█████▍    | 13617/25250 [00:04<00:04, 2373.37 examples/s]Generating validation split:  56%|█████▌    | 14017/25250 [00:04<00:05, 2001.32 examples/s]Generating validation split:  57%|█████▋    | 14517/25250 [00:04<00:05, 2058.70 examples/s]Generating validation split:  59%|█████▉    | 15017/25250 [00:04<00:04, 2357.91 examples/s]Generating validation split:  61%|██████    | 15417/25250 [00:04<00:03, 2469.11 examples/s]Generating validation split:  62%|██████▏   | 15717/25250 [00:04<00:04, 2344.43 examples/s]Generating validation split:  64%|██████▍   | 16117/25250 [00:05<00:04, 2123.30 examples/s]Generating validation split:  65%|██████▌   | 16417/25250 [00:05<00:05, 1745.72 examples/s]Generating validation split:  66%|██████▌   | 16617/25250 [00:05<00:05, 1708.50 examples/s]Generating validation split:  67%|██████▋   | 16934/25250 [00:05<00:04, 1908.31 examples/s]Generating validation split:  68%|██████▊   | 17234/25250 [00:05<00:04, 1868.96 examples/s]Generating validation split:  69%|██████▉   | 17434/25250 [00:06<00:05, 1431.73 examples/s]Generating validation split:  70%|██████▉   | 17634/25250 [00:06<00:05, 1441.02 examples/s]Generating validation split:  71%|███████   | 17834/25250 [00:06<00:05, 1356.02 examples/s]Generating validation split:  71%|███████▏  | 18034/25250 [00:06<00:05, 1390.62 examples/s]Generating validation split:  72%|███████▏  | 18234/25250 [00:06<00:04, 1496.74 examples/s]Generating validation split:  74%|███████▍  | 18734/25250 [00:06<00:03, 2161.02 examples/s]Generating validation split:  76%|███████▌  | 19134/25250 [00:07<00:02, 2118.50 examples/s]Generating validation split:  77%|███████▋  | 19434/25250 [00:07<00:02, 1965.64 examples/s]Generating validation split:  79%|███████▊  | 19834/25250 [00:07<00:02, 2156.76 examples/s]Generating validation split:  80%|███████▉  | 20134/25250 [00:07<00:02, 1934.59 examples/s]Generating validation split:  81%|████████▏ | 20534/25250 [00:07<00:02, 1942.49 examples/s]Generating validation split:  83%|████████▎ | 21034/25250 [00:07<00:01, 2304.85 examples/s]Generating validation split:  84%|████████▍ | 21334/25250 [00:08<00:01, 1978.64 examples/s]Generating validation split:  86%|████████▌ | 21634/25250 [00:08<00:01, 2003.42 examples/s]Generating validation split:  87%|████████▋ | 21934/25250 [00:08<00:01, 1908.53 examples/s]Generating validation split:  88%|████████▊ | 22134/25250 [00:08<00:01, 1890.07 examples/s]Generating validation split:  88%|████████▊ | 22334/25250 [00:08<00:01, 1688.94 examples/s]Generating validation split:  90%|█████████ | 22734/25250 [00:08<00:01, 2077.89 examples/s]Generating validation split:  92%|█████████▏| 23134/25250 [00:09<00:00, 2131.66 examples/s]Generating validation split:  93%|█████████▎| 23434/25250 [00:09<00:00, 2085.01 examples/s]Generating validation split:  94%|█████████▍| 23834/25250 [00:09<00:00, 1763.03 examples/s]Generating validation split:  95%|█████████▌| 24034/25250 [00:09<00:00, 1801.81 examples/s]Generating validation split:  97%|█████████▋| 24434/25250 [00:09<00:00, 1801.23 examples/s]Generating validation split:  98%|█████████▊| 24634/25250 [00:09<00:00, 1822.11 examples/s]Generating validation split:  99%|█████████▊| 24934/25250 [00:10<00:00, 1699.82 examples/s]Generating validation split: 100%|█████████▉| 25134/25250 [00:10<00:00, 1075.04 examples/s]Generating validation split: 100%|██████████| 25250/25250 [00:10<00:00, 2334.24 examples/s]
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-large-patch16-224 and are newly initialized because the shapes did not match:
- classifier.weight: found shape torch.Size([1000, 1024]) in the checkpoint and torch.Size([101, 1024]) in the model instantiated
- classifier.bias: found shape torch.Size([1000]) in the checkpoint and torch.Size([101]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
✓ Dataset loaded
  - Train samples: 75,750
  - Test samples: 25,250
  - Classes: 101

Step 2: Loading ViT-Large model...
✓ Model loaded
  - Architecture: ViT-Large
  - Parameters: 303,405,157
  - Trainable params: 303,405,157

Step 3: Setting up data augmentation...
  - Applying augmentation to training set...
  - Applying preprocessing to validation set...
✓ Data augmentation configured

Step 4: Setting up training configuration...
Downloading builder script: 0.00B [00:00, ?B/s]Downloading builder script: 4.20kB [00:00, 3.47MB/s]
Traceback (most recent call last):
  File "/Users/filip/Documents/applications/Food1/model_conversion/train_vit_large.py", line 119, in <module>
    accuracy = evaluate.load("accuracy")
  File "/Users/filip/Documents/applications/Food1/model_conversion/mlenv/lib/python3.10/site-packages/evaluate/loading.py", line 748, in load
    evaluation_module = evaluation_module_factory(
  File "/Users/filip/Documents/applications/Food1/model_conversion/mlenv/lib/python3.10/site-packages/evaluate/loading.py", line 680, in evaluation_module_factory
    raise e1 from None
  File "/Users/filip/Documents/applications/Food1/model_conversion/mlenv/lib/python3.10/site-packages/evaluate/loading.py", line 639, in evaluation_module_factory
    ).get_module()
  File "/Users/filip/Documents/applications/Food1/model_conversion/mlenv/lib/python3.10/site-packages/evaluate/loading.py", line 489, in get_module
    local_imports = _download_additional_modules(
  File "/Users/filip/Documents/applications/Food1/model_conversion/mlenv/lib/python3.10/site-packages/evaluate/loading.py", line 265, in _download_additional_modules
    raise ImportError(
ImportError: To be able to use evaluate-metric/accuracy, you need to install the following dependencies['scikit-learn'] using 'pip install sklearn' for instance'
